$(document).ready(function(){$(".checkdiv").on("click",function(){$(this).hasClass("checkmark")?$(this).removeClass("checkmark"):$(this).addClass("checkmark")}),$("#loginModal").modal({show:!1,backdrop:!1}),$("tbody").on("click","span",function(){var t=$(this),n=t.parent(),a=t.attr("class").split(" ");a[1]=a[1]?"del":"add";var e="operation.php",d=$.param({submit:a[0]+a[1],user:n.siblings().children("a.name").text()},!0);$.post(e,d,function(n){var n=$.parseJSON(n),a=t.text().substring(1);return n&&(n!=a-1?(a++,t.addClass("add").text("+"+a)):(a--,t.removeClass("add").text("+"+a))),!1})}),$("#add").on("click",function(){var t='<div id="#addMember"><input type="text" placeholder="新成员姓名"><button id="addBtn" type="button" class="btn">确定</button><button id="addCancleBtn" type="button" class="btn">取消</button></div>',n=$(".dropdown");n.prepend(t),n.find("input").focus(),n.find("#addCancleBtn").on("click",function(){n.find("div").fadeOut(100)})}),$(".dropdown").delegate("#addBtn","click",function(){var t=$(this).siblings("input").val(),n=$(".alert"),a=$.param({submit:"add",user:t},"true");n.slideDown(100),$.post("operation.php",a,function(a){if("OKADD"===a.toUpperCase()){var e='<tr><td><div class="checkdiv"></div></td><td><a class="name" href="#">'+t+"</a></td>"+'<td><span class="uarrive">+0</span></td>'+'<td><span class="vacate">+0</span></td>'+'<td><span class="late">+0</span></td>'+'<td><span class="arrive">+0</span></td>'+"<td>0</td>"+"</tr>";$("tbody").append(e),n.text("已添加，确认请查看列表")}else"用户名已存在"===a&&n.text("成员已存在")})}),$("#del").on("click",function(){var t,n=$("td div.checkmark"),a=[],e="operation.php",d=$(".alert");d.slideDown(100);for(var i=n.length-1;i>=0;i--)a[i]=n.eq(i).parent().parent().find("a").text(),t=$.param({submit:"del",user:a[i]},!0),$.post(e,t,function(t){"OKDEL"===t.toUpperCase()&&(n.parent().parent().hide(),d.text("已成功删除"))})}),$("#update").on("submit",function(){event.preventDefault();var t=$(".alert");t.slideDown(100),$.post("peration.php",$(this).serialize()+"&submit=update",function(n){"OKUPDATE"===n.toUpperCase()?($("input").val(""),t.text("提交成功！")):t.text("失败了... T^T")})})});