$(document).ready(function(){$(".checkdiv").on("click",function(){$(this).hasClass("checkmark")?$(this).removeClass("checkmark"):$(this).addClass("checkmark")}),$("#loginModal").modal({show:!1,backdrop:!1}),$("tbody").on("click","span",function(){var t=$(this),a=t.parent(),e=t.attr("class").split(" ");e[1]=e[1]?"del":"add";var n="operation.php",d=$.param({submit:e[0]+e[1],user:a.siblings().children("a.name").text()},!0);$.post(n,d,function(a){var a=$.parseJSON(a),e=t.text().substring(1);return a&&(a!=e-1?(e++,t.addClass("add").text("+"+e)):(e--,t.removeClass("add").text("+"+e))),!1})}),$("#add").on("click",function(){var t='<div id="#addMember"><input type="text" placeholder="新成员姓名"><button id="addBtn" type="button" class="btn">确定</button><button id="addCancleBtn" type="button" class="btn">取消</button></div>',a=$(".dropdown");a.prepend(t),a.find("input").focus(),a.find("#addCancleBtn").on("click",function(){a.find("div").fadeOut(100)})}),$(".dropdown").delegate("#addBtn","click",function(){var t=$(this).siblings("input").val(),a=$(".alert"),e=$.param({submit:"add",user:t},"true");a.slideDown(100),$.post("operation.php",e,function(e){if("OKADD"===e.toUpperCase()){var n='<tr><td><div class="checkdiv"></div></td><td><a class="name" href="person.php?user='+t+'">'+t+"</a></td>"+'<td><span class="uarrive">+0</span></td>'+'<td><span class="vacate">+0</span></td>'+'<td><span class="late">+0</span></td>'+'<td><span class="arrive">+0</span></td>'+"<td>0</td>"+"</tr>";$("tbody").append(n),a.text("已添加，确认请查看列表")}else"用户名已存在"===e&&a.text("成员已存在")})}),$("#del").on("click",function(){var t,a=$("td div.checkmark"),e=[],n="operation.php",d=$(".alert");d.slideDown(100);for(var s=a.length-1;s>=0;s--)e[s]=a.eq(s).parent().parent().find("a").text(),t=$.param({submit:"del",user:e[s]},!0),$.post(n,t,function(t){"OKDEL"===t.toUpperCase()&&(a.parent().parent().hide(),d.text("已成功删除"))})}),$("#update").on("submit",function(){event.preventDefault();var t=$(".alert");t.slideDown(100),$.post("operation.php",$(this).serialize()+"&submit=update",function(a){"OKUPDATE"===a.toUpperCase()?($("input").val(""),t.text("提交成功！")):t.text("失败了... T^T")})})});